---
title: "Midterm 1"
output: pdf_document
---

```{r, include = FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)


library(psych)
library(mediation)
library(janitor)
library(haven)
library(tidyverse)

```

```{r}


# Load Data

all_data <- read_dta("dataverse_files/replicationdata.dta") %>% clean_names()


```


```{r}

# Table 1 in paper
# (1)

lm( data = filter(all_data, anxcond3 > 0), formula = scd_brad_self_report1_mean ~ anxcond, na.omit = TRUE) 


# (2) 

lm( data = filter(all_data, anxcond3 > 0), immigration ~ storycond + anxcond + scd_brad_self_report1_mean) 






```


```{r}

# figure 2




```







```{r}
# figure 3

# Causal Mediation Plot


noRelaxCond <- filter(all_data, anxcond3 > 0)

# Outcome Model
y <- lm(formula = immigration ~ anxcond + scd_brad_self_report1_mean + storycond, data= noRelaxCond)

# Mediator Model
m<-lm(formula = scd_brad_self_report1_mean ~ anxcond + storycond, data = noRelaxCond)

# Mediation Analysis
m.out<-mediate(m,y, sims=500, treat="anxcond", mediator="scd_brad_self_report1_mean", dropobs=TRUE, boot=TRUE, conf.level=.90)

plot(m.out, labels=c("ACME\n(Physiological \nReactivity)", "Direct Effect \n(Anxiety)", "Total Effect"))



```


